from textwrap import dedent
import time


DEFAULT_FILENAME_PROMPT = dedent("""
请你作为一名专业的文件管理员，按照以下严格规则为我提供的法律文件命名。

1.  **命名结构**：`[文件核心类型]（[案件双方]）_[年月日]收`
    *   方括号 `[]` 中的内容为需要你填写的变量。
    *   书名号 `“”` 仅用于包裹文件标题，本身不是文件名的一部分。
    *   括号 `（）` 和下划线 `_` 是文件名的固定组成部分。

2.  **文件核心类型**：
    *   从文件标题中提取最关键的法律文书类型。
    *   例如：`“交纳诉讼费用通知书”` -> `交纳诉讼费用通知书`；`“民事判决书（2023）粤01民终1234号”` -> `民事判决书`。
    *   常见类型包括但不限于：`传票`、`通知书`、`判决书`、`裁定书`、`调解书`、`决定书`、`支付令`、`交纳诉讼费用通知书`、`反驳意见`、`质证意见`、`应诉通知书`、`举证通知书`等。

3.  **案件双方**：
    *   格式为 `[甲方]与[乙方]案件`。
    *   `甲方`和`乙方`是案件的核心当事人。通常是原告与被告、第三人，或申请人与被申请人，上诉人与被上诉人、原审第三人等。
    *   请从文件正文中提取完整、准确的姓名或单位全称。
    *   示例：文件中提到“原告：王开心；被告：汪猪猪；被告：大狗狗” -> `王开心与汪猪猪、大狗狗案件`。
    *   示例2：文件中提到“原告：王开心；被告：汪猪猪；第三人：小笨蛋” -> `王开心与汪猪猪、大笨蛋案件`。

4.  **年月日**：
    *   使用今天的系统日期，格式为8位数字 `YYYYMMDD`。
    *   **当前日期：{current_date}**
    *   你必须使用上面提供的这个日期，无需自行更改或计算。

5.  **命名示例**：
    *   输入文件标题为“交纳诉讼费用通知书”，当事人为“王开心”与“汪猪猪” -> `交纳诉讼费用通知书（王开心与汪猪猪案件）_20251113收`
    *   输入文件标题为“民事判决书”，当事人为“广州市西山咀百货有限公司”诉“佛山市浦满贸易有限公司、梁伟龙、张俊萱” -> `民事判决书（广州市西山咀百货有限公司与佛山市浦满贸易有限公司、梁伟龙、张俊萱案件）_20251111收`

6.  **输出要求**：
    *   请严格按照上述规则生成一个唯一的文件名。
    *   直接返回最终的文件名字符串，不要添加任何额外的解释、说明、标点符号或代码块标记。
    *   请删除所有空格。
""").strip()

# 2. 生成当前日期，并将其格式化到模板中
current_date_str = time.strftime('%Y%m%d')
DEFAULT_FILENAME_PROMPT = DEFAULT_FILENAME_PROMPT.format(current_date=current_date_str)


def build_prompt(base: str, text: str) -> str:
    return f"{base}\n\n{text}"
